import{a as v,b as O,e as k,g as A,h as W,i as K,j as T,k as D,l as I,n as V}from"./chunk-QBKVUF7L.js";import{f as P}from"./chunk-PK5YRH4Z.js";import{a as E}from"./chunk-Q7Y4YLXA.js";import"./chunk-YOOGVOXO.js";import{$a as h,Da as b,Oa as y,Pa as S,R as f,Va as e,W as C,Wa as t,X as _,bb as x,db as c,nb as n,qa as s,rb as p,sb as m,tb as g}from"./chunk-LQHLUY7B.js";import{c as M}from"./chunk-2VMXMS7J.js";function R(d,l){if(d&1){let i=h();e(0,"div",5)(1,"label",16),n(2,"Cl\xE9 API Anthropic"),t(),e(3,"input",17),g("ngModelChange",function(a){C(i);let o=c();return m(o.claudeKey,a)||(o.claudeKey=a),_(a)}),t(),e(4,"p",13),n(5,"Cl\xE9 stock\xE9e uniquement sur cet appareil."),t()()}if(d&2){let i=c();s(3),p("ngModel",i.claudeKey)}}function j(d,l){if(d&1){let i=h();e(0,"div",5)(1,"label",18),n(2,"Cl\xE9 API OpenAI"),t(),e(3,"input",19),g("ngModelChange",function(a){C(i);let o=c();return m(o.openaiKey,a)||(o.openaiKey=a),_(a)}),t(),e(4,"p",13),n(5,"Cl\xE9 stock\xE9e uniquement sur cet appareil."),t()()}if(d&2){let i=c();s(3),p("ngModel",i.openaiKey)}}var N=class d{sp=f(P);toast=f(E);aiProvider="none";claudeKey="";openaiKey="";corrWindow=8;ngOnInit(){let l=this.sp.getSettings();this.aiProvider=l.aiProvider,this.claudeKey=l.claudeApiKey??"",this.openaiKey=l.openaiApiKey??"",this.corrWindow=l.correlationWindowHours}save(){this.sp.saveSettings({aiProvider:this.aiProvider,claudeApiKey:this.claudeKey||void 0,openaiApiKey:this.openaiKey||void 0,correlationWindowHours:this.corrWindow}),this.toast.success("R\xE9glages sauvegard\xE9s")}export(){return M(this,null,function*(){try{let{getGutTrackDb:l}=yield import("./chunk-POWTRZHM.js"),i=l(),[r,a,o]=yield Promise.all([i.meals.toArray(),i.symptoms.toArray(),i.medications.toArray()]),z={exportDate:new Date().toISOString(),meals:r,symptoms:a,medications:o},L=new Blob([JSON.stringify(z,null,2)],{type:"application/json"}),w=URL.createObjectURL(L),u=document.createElement("a");u.href=w,u.download=`guttrack-${new Date().toISOString().split("T")[0]}.json`,u.click(),URL.revokeObjectURL(w),this.toast.success("Donn\xE9es export\xE9es")}catch{this.toast.error("Erreur lors de l'export")}})}static \u0275fac=function(i){return new(i||d)};static \u0275cmp=b({type:d,selectors:[["app-settings"]],decls:36,vars:4,consts:[[1,"page"],[1,"ph"],[1,"form"],[1,"sec"],[1,"st"],[1,"field"],["for","aip",1,"fl"],["id","aip",1,"fi",3,"ngModelChange","ngModel"],["value","none"],["value","claude"],["value","openai"],["for","cw",1,"fl"],["id","cw","type","number","min","1","max","24",1,"fi",3,"ngModelChange","ngModel"],[1,"hint"],[1,"exp-btn",3,"click"],[1,"btn-primary",3,"click"],["for","ck",1,"fl"],["id","ck","type","password","placeholder","sk-ant-...","autocomplete","off",1,"fi",3,"ngModelChange","ngModel"],["for","ok",1,"fl"],["id","ok","type","password","placeholder","sk-...","autocomplete","off",1,"fi",3,"ngModelChange","ngModel"]],template:function(i,r){i&1&&(e(0,"div",0)(1,"header",1)(2,"h1"),n(3,"R\xE9glages"),t()(),e(4,"div",2)(5,"section",3)(6,"h2",4),n(7,"Provider IA"),t(),e(8,"div",5)(9,"label",6),n(10,"Service d'analyse"),t(),e(11,"select",7),g("ngModelChange",function(o){return m(r.aiProvider,o)||(r.aiProvider=o),o}),e(12,"option",8),n(13,"Aucun"),t(),e(14,"option",9),n(15,"Claude (Anthropic)"),t(),e(16,"option",10),n(17,"GPT-4o (OpenAI)"),t()()(),y(18,R,6,1,"div",5),y(19,j,6,1,"div",5),t(),e(20,"section",3)(21,"h2",4),n(22,"Corr\xE9lation"),t(),e(23,"div",5)(24,"label",11),n(25,"Fen\xEAtre (heures)"),t(),e(26,"input",12),g("ngModelChange",function(o){return m(r.corrWindow,o)||(r.corrWindow=o),o}),t(),e(27,"p",13),n(28,"Dur\xE9e apr\xE8s un repas pour associer des sympt\xF4mes."),t()()(),e(29,"section",3)(30,"h2",4),n(31,"Donn\xE9es"),t(),e(32,"button",14),x("click",function(){return r.export()}),n(33,"\u{1F4E5} Exporter (JSON)"),t()(),e(34,"button",15),x("click",function(){return r.save()}),n(35,"Enregistrer"),t()()()),i&2&&(s(11),p("ngModel",r.aiProvider),s(7),S(r.aiProvider==="claude"?18:-1),s(),S(r.aiProvider==="openai"?19:-1),s(7),p("ngModel",r.corrWindow))},dependencies:[V,K,T,v,A,W,O,I,D,k],styles:[".page[_ngcontent-%COMP%]{padding:1rem;max-width:600px;margin:0 auto}.ph[_ngcontent-%COMP%]{margin-bottom:1.5rem}.ph[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:700;margin:0}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.sec[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.85rem;padding:1rem;background:#fafafa;border-radius:12px;border:1px solid #eee}.st[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;margin:0}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.35rem}.fl[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#666}.fi[_ngcontent-%COMP%]{padding:.75rem;border:1.5px solid #ddd;border-radius:10px;font-size:.95rem;width:100%;box-sizing:border-box;background:#fff}.hint[_ngcontent-%COMP%]{font-size:.75rem;color:#888;margin:0}.btn-primary[_ngcontent-%COMP%]{padding:1rem;border-radius:12px;border:none;background:#2e7d32;color:#fff;font-size:1rem;font-weight:600;cursor:pointer}.exp-btn[_ngcontent-%COMP%]{padding:.75rem 1rem;border-radius:10px;border:1.5px solid #ddd;background:#fff;cursor:pointer;font-size:.9rem;text-align:left}"]})};export{N as SettingsComponent};
