import{a as te,b as ne,c as ie,d as oe,e as re}from"./chunk-OF5P4Z6E.js";import{a as G,b as q}from"./chunk-OGJOIL4K.js";import{a as J,b as K,c as Q,d as U,e as X,f as Z,n as ee}from"./chunk-QBKVUF7L.js";import{a as le}from"./chunk-AUGRQXUW.js";import{a as W}from"./chunk-WKM2OYV4.js";import{b as $}from"./chunk-PK5YRH4Z.js";import{a as H}from"./chunk-Q7Y4YLXA.js";import{c as j}from"./chunk-EGESI55J.js";import"./chunk-YOOGVOXO.js";import{$a as y,Da as h,Db as w,Eb as I,M as D,Oa as v,Pa as P,R as C,Ra as x,Sa as M,Ta as E,Ua as T,Va as a,W as u,Wa as p,X as f,Ya as l,Za as m,_a as z,bb as _,ca as S,cb as O,db as d,kb as V,lb as b,nb as r,ob as g,qa as o,rb as R,sb as A,tb as Y}from"./chunk-LQHLUY7B.js";import{c as k}from"./chunk-2VMXMS7J.js";function me(i,n){if(i&1){let e=y();l(0,"button",5),O("click",function(){let c=u(e).$implicit,s=d();return f(s.changed.emit(c))}),l(1,"span"),r(2),m(),z(3,"span",6),m()}if(i&2){let e=n.$implicit,t=d();V("--l",e),b("sel",t.selected()===e),o(2),g(e)}}var F=class i{levels=[1,2,3,4,5];selected=I(3);changed=w();getLabel(n){return ne[n]??""}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=h({type:i,selectors:[["app-intensity-slider"]],inputs:{selected:[1,"selected"]},outputs:{changed:"changed"},decls:8,vars:1,consts:[[1,"selector"],[1,"lbl"],[1,"levels"],["type","button",1,"lvl-btn",3,"sel","--l"],[1,"label-text"],["type","button",1,"lvl-btn",3,"click"],[1,"bar"]],template:function(e,t){e&1&&(l(0,"div",0)(1,"label",1),r(2,"Intensit\xE9"),m(),l(3,"div",2),M(4,me,4,5,"button",3,x),m(),l(6,"div",4),r(7),m()()),e&2&&(o(4),E(t.levels),o(3),g(t.getLabel(t.selected())))},styles:[".selector[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.lbl[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#666}.levels[_ngcontent-%COMP%]{display:flex;gap:.5rem}.lvl-btn[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;gap:.25rem;border:2px solid transparent;border-radius:8px;padding:.5rem .25rem;background:#f5f5f5;cursor:pointer;transition:all .15s}.lvl-btn.sel[_ngcontent-%COMP%]{border-color:currentColor;background:#fff3e0}.lvl-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:1rem;font-weight:700}.lvl-btn[_ngcontent-%COMP%]:nth-child(1)   span[_ngcontent-%COMP%]:first-child{color:#43a047}.lvl-btn[_ngcontent-%COMP%]:nth-child(2)   span[_ngcontent-%COMP%]:first-child{color:#7cb342}.lvl-btn[_ngcontent-%COMP%]:nth-child(3)   span[_ngcontent-%COMP%]:first-child{color:#f9a825}.lvl-btn[_ngcontent-%COMP%]:nth-child(4)   span[_ngcontent-%COMP%]:first-child{color:#f57c00}.lvl-btn[_ngcontent-%COMP%]:nth-child(5)   span[_ngcontent-%COMP%]:first-child{color:#c62828}.bar[_ngcontent-%COMP%]{width:100%;height:calc(var(--l) * 4px + 4px);border-radius:4px;background:hsl(calc(120 - var(--l) * 20),70%,50%)}.label-text[_ngcontent-%COMP%]{font-size:.8rem;color:#888;text-align:center;min-height:1.2em}"]})};function ce(i,n){if(i&1){let e=y();l(0,"button",4),O("click",function(){let c=u(e).$implicit,s=d();return f(s.changed.emit(c))}),l(1,"span",5),r(2),m(),l(3,"span",6),r(4),m()()}if(i&2){let e=n.$implicit,t=d();b("sel",t.selected()===e),o(2),g(e),o(2),g(t.SHORT[e])}}function pe(i,n){if(i&1&&(l(0,"p",7),r(1),m()),i&2){let e=d();o(),g(e.getFullLabel(e.selected()))}}var L=class i{SHORT=re;types=[1,2,3,4,5,6,7];selected=I(void 0);changed=w();getFullLabel(n){return oe[n]??""}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=h({type:i,selectors:[["app-bristol-scale-picker"]],inputs:{selected:[1,"selected"]},outputs:{changed:"changed"},decls:12,vars:3,consts:[[1,"picker"],[1,"lbl"],[1,"grid"],["type","button",1,"btn",3,"sel"],["type","button",1,"btn",3,"click"],[1,"num"],[1,"short"],[1,"desc"]],template:function(e,t){e&1&&(l(0,"div",0)(1,"label",1),r(2,"\xC9chelle de Bristol (optionnel)"),m(),l(3,"div",2),M(4,ce,5,4,"button",3,x),l(6,"button",4),O("click",function(){return t.changed.emit(void 0)}),l(7,"span",5),r(8,"\u2014"),m(),l(9,"span",6),r(10,"Aucun"),m()()(),v(11,pe,2,1,"p",7),m()),e&2&&(o(4),E(t.types),o(2),b("sel",t.selected()===void 0),o(5),P(t.selected()?11:-1))},styles:[".picker[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.lbl[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#666}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:.4rem}.btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.2rem;padding:.5rem .25rem;border-radius:8px;border:2px solid #e0e0e0;background:#fff;cursor:pointer;transition:all .15s}.btn.sel[_ngcontent-%COMP%]{border-color:#2e7d32;background:#e8f5e9}.num[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700}.short[_ngcontent-%COMP%]{font-size:.6rem;color:#888;text-align:center;line-height:1.2}.desc[_ngcontent-%COMP%]{font-size:.8rem;color:#666;padding:.5rem;background:#f5f5f5;border-radius:8px;margin:0}"]})};var N=class i{repo=C($);execute(n){return k(this,null,function*(){let e={id:le(),timestamp:W(n.timestampMs),symptomType:n.symptomType,intensity:te(n.intensity),bristolScale:n.bristolScale?ie(n.bristolScale):void 0,notes:n.notes};return yield this.repo.save(e),{id:e.id,timestamp:e.timestamp,symptomType:e.symptomType,intensity:e.intensity,bristolScale:e.bristolScale,notes:e.notes}})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=D({token:i,factory:i.\u0275fac,providedIn:"root"})};function de(i,n){if(i&1){let e=y();a(0,"button",15),_("click",function(){let c=u(e).$implicit,s=d();return f(s.selType.set(c))}),r(1),p()}if(i&2){let e=n.$implicit,t=d();b("sel",t.selType()===e),o(),g(t.label(e))}}function ge(i,n){if(i&1){let e=y();a(0,"app-bristol-scale-picker",8),_("changed",function(c){u(e);let s=d();return f(s.bristol.set(c))}),p()}if(i&2){let e=d();T("selected",e.bristol())}}function ue(i,n){i&1&&r(0,"Enregistrement...")}function fe(i,n){i&1&&r(0,"Enregistrer")}var ae=class i{handler=C(N);router=C(j);toast=C(H);types=q;selType=S(null);intensity=S(3);bristol=S(void 0);submitting=S(!1);dt=S(this.nowLocal());notes="";label(n){return G[n]}back(){this.router.navigate(["/symptoms"])}submit(){return k(this,null,function*(){if(!(!this.selType()||this.submitting())){this.submitting.set(!0);try{yield this.handler.execute({symptomType:this.selType(),intensity:this.intensity(),bristolScale:this.bristol(),notes:this.notes||void 0,timestampMs:new Date(this.dt()).getTime()}),this.toast.success("Sympt\xF4me enregistr\xE9"),this.router.navigate(["/symptoms"])}catch{this.toast.error("Erreur lors de l'enregistrement")}finally{this.submitting.set(!1)}}})}nowLocal(){let n=new Date;return n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),n.toISOString().slice(0,16)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=h({type:i,selectors:[["app-symptom-form"]],decls:26,vars:6,consts:[[1,"page"],[1,"ph"],[1,"back",3,"click"],[1,"form",3,"ngSubmit"],[1,"field"],[1,"fl"],[1,"chips"],["type","button",1,"chip",3,"sel"],[3,"changed","selected"],[3,"selected"],["for","st",1,"fl"],["id","st","type","datetime-local","name","dt",1,"fi",3,"ngModelChange","ngModel"],["for","sn",1,"fl"],["id","sn","name","notes","rows","3","placeholder","Contexte, d\xE9clencheur...",1,"fi","fi-ta",3,"ngModelChange","ngModel"],["type","submit",1,"btn-primary",3,"disabled"],["type","button",1,"chip",3,"click"]],template:function(e,t){e&1&&(a(0,"div",0)(1,"header",1)(2,"button",2),_("click",function(){return t.back()}),r(3,"\u2190 Retour"),p(),a(4,"h1"),r(5,"Enregistrer un sympt\xF4me"),p()(),a(6,"form",3),_("ngSubmit",function(){return t.submit()}),a(7,"div",4)(8,"label",5),r(9,"Type de sympt\xF4me"),p(),a(10,"div",6),M(11,de,2,3,"button",7,x),p()(),a(13,"app-intensity-slider",8),_("changed",function(s){return t.intensity.set(s)}),p(),v(14,ge,1,1,"app-bristol-scale-picker",9),a(15,"div",4)(16,"label",10),r(17,"Date et heure"),p(),a(18,"input",11),_("ngModelChange",function(s){return t.dt.set(s)}),p()(),a(19,"div",4)(20,"label",12),r(21,"Notes"),p(),a(22,"textarea",13),Y("ngModelChange",function(s){return A(t.notes,s)||(t.notes=s),s}),p()(),a(23,"button",14),v(24,ue,1,0)(25,fe,1,0),p()()()),e&2&&(o(11),E(t.types),o(2),T("selected",t.intensity()),o(),P(t.selType()==="diarrhea"||t.selType()==="constipation"?14:-1),o(4),T("ngModel",t.dt()),o(4),R("ngModel",t.notes),o(),T("disabled",!t.selType()||t.submitting()),o(),P(t.submitting()?24:25))},dependencies:[ee,Z,J,K,Q,X,U,F,L],styles:[".page[_ngcontent-%COMP%]{padding:1rem;max-width:600px;margin:0 auto}.ph[_ngcontent-%COMP%]{margin-bottom:1.5rem}.ph[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;margin:.5rem 0 0}.back[_ngcontent-%COMP%]{background:none;border:none;color:#2e7d32;cursor:pointer;font-size:.9rem;padding:0}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem}.fl[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#666}.fi[_ngcontent-%COMP%]{padding:.75rem;border:1.5px solid #ddd;border-radius:10px;font-size:.95rem;width:100%;box-sizing:border-box}.fi-ta[_ngcontent-%COMP%]{resize:vertical;min-height:80px;font-family:inherit}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.chip[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:20px;border:1.5px solid #ddd;background:#fff;cursor:pointer;font-size:.85rem;transition:all .15s}.chip.sel[_ngcontent-%COMP%]{background:#e8eaf6;border-color:#3949ab;color:#3949ab;font-weight:600}.btn-primary[_ngcontent-%COMP%]{padding:1rem;border-radius:12px;border:none;background:#2e7d32;color:#fff;font-size:1rem;font-weight:600;cursor:pointer}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6}"]})};export{ae as SymptomFormComponent};
